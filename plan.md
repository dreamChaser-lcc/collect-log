# 埋点日志系统
    技术栈：express + js + sentry
    express负责编译生成js脚本
    sentry负责统计日志平台

## 实现
方案流程图:plan.drawio文件

### 注册钩子事件
提供触发埋点的执行回调

### 采集pv (首次进入页面)
加载脚本结束后，调用加载结束事件，将当前页面路径加上其他需要的信息提交上传

### on-visible（曝光节点）
监听滚动事件，查找在当前窗口的绑定了on-visible类名的节点，找到之后调用visible曝光钩子事件，并且将节点打上标记，避免再次将事件曝光

### on-log (点击节点)
添加body监听事件，根据事件委托原理找到点击的目标节点，递归冒泡向上查找，是否存在 on-log类名。找到则提交日志请求
